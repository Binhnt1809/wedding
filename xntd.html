<!DOCTYPE html>
<!-- saved from url=(0038)https://hoabinh2024.iwedding.info/rsvp -->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="author" content="Biihappy" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Hòa &amp; Bình - Xác nhận tham dự</title>
    <link href="./xntd_files/css2" rel="stylesheet" />
    <link
      href="./xntd_files/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Coiny&display=swap"
      rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Coiny&family=Jura:wght@300..700&display=swap"
      rel="stylesheet" />
    <style>
      .container {
        max-width: 650px;
      }

      #search-form h1 {
        font-family: "Jura", sans-serif;
        font-size: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin: 0;
      }

      #search-form h1 span {
        padding: 0 15px;
      }

      @media only screen and (max-width: 410px) {
        #search-form h1 {
          font-size: 30px !important;
        }
      }

      @media only screen and (max-width: 374px) {
        #search-form h1 {
          font-size: 22px !important;
        }
      }

      .error {
        color: red;
      }

      .bg-gray-200 {
        background-color: #f1f4f8 !important;
      }

      .bg-gray-300 {
        background-color: #d9e2ef !important;
      }

      .text-gray-700 {
        color: #506690 !important;
      }

      .form-select.is-invalid,
      .was-validated .form-select:invalid {
        border-color: #dc3545 !important;
      }
    </style>
    <style>
      /* Bước 2: CSS cho lớp phủ */
      #loading-overlay {
          display: none; /* Ẩn lớp phủ ban đầu */
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          z-index: 1000;
          align-items: center;
          justify-content: center;
      }

      .spinner {
          border: 16px solid #f3f3f3;
          border-radius: 50%;
          border-top: 16px solid #3498db;
          width: 120px;
          height: 120px;
          -webkit-animation: spin 2s linear infinite;
          animation: spin 2s linear infinite;
      }

      @-webkit-keyframes spin {
          0% { -webkit-transform: rotate(0deg); }
          100% { -webkit-transform: rotate(360deg); }
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }
  </style>
    <script
      type="text/javascript"
      async=""
      src="./xntd_files/analytics.js"></script>
    <script type="text/javascript" async="" src="./xntd_files/js"></script>
    <script async="" src="./xntd_files/js(1)"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-K9L0ZFE1PJ");
    </script>
  </head>

  <body cz-shortcut-listen="true">
    <div class="border-bottom rounded-0 bg-gray-200 p-3 pt-4">
      <div class="text-center m-auto" style="max-width: 150px">
        <img
          class="w-100 border p-1 border-2 rounded-circle border-danger"
          src="./4.jpg" />
      </div>
      <div>
        <h2
          class="text-center mt-3 mb-0 fs-3 text-uppercase"
          style="font-family: 'Coiny'">
          Xác nhận tham dự
        </h2>
        <p
          class="text-center mb-0"
          style="font-family: 'Jura'; font-size: 22px">
          Đám cưới của
        </p>
        <div class="d-flex flex-wrap align-items-center justify-content-center">
          <h1 class="mb-0 fs-4">
            <span>Phan Hòa</span>
            <img height="50" src="./xntd_files/heart.gif" />
            <span>Nguyễn Bình</span>
          </h1>
        </div>
      </div>
    </div>
    <main class="container">
      <div id="camOn" style="text-align: center;">
        &nbsp;
        <form id="search-form" method="post" novalidate="novalidate">
          <div>
            <label
              class="pb-2 text-center d-block text-black"
              for="name"
              style="font-family: 'Jura'; font-size: 20px"
              >Nhập Tên của bạn</label
            >
            <input
              type="text"
              id="name"
              name="entry.550506478"
              class="form-control form-control-lg rounded-0 text-center"
              autocomplete="off"
              placeholder="---" />
            <input hidden type="text" id="id" name="entry.516692212" />
          </div>
          <div class="errors mt-1 text-danger text-center"></div>
          <button
            id="submitThamDu"
            type="submit"
            class="btn btn-lg btn-danger text-center w-100 mt-4">
            Xác nhận tham dự
          </button>
        </form>
        <iframe name="hidden-iframe" style="display: none"></iframe>
      </div>
      <div>
        <div class="row gx-3 mt-3 mb-5">
          <a id="rollback_home" class="text-center">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-arrow-left-short"
              viewBox="0 0 16 16">
              <path
                fill-rule="evenodd"
                d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z"></path>
            </svg>
            Về website đám cưới
          </a>
        </div>
      </div>
    </main>
    <div id="loading-overlay">
      <div class="spinner"></div>
  </div>
    <script src="./xntd_files/script.js"></script>
    <script>
      var urlParams = new URLSearchParams(window.location.search);
      var date = urlParams.get("date");
      var id = urlParams.get("id");

      $("a").attr(
        "href",
        `${window.location.href.substring(
          0,
          window.location.href.lastIndexOf("xntd.html")
        )}index.html?id=${id}`
      );

      function isValidDate(dateString) {
        var regEx = /^\d{2}\/\d{2}\/\d{4}$/;
        if (!dateString.match(regEx)) return false;
        var parts = dateString.split("/");
        var day = parseInt(parts[0], 10);
        var month = parseInt(parts[1], 10);
        var year = parseInt(parts[2], 10);
        if (year < 1000 || year > 9999 || month == 0 || month > 12)
          return false;
        var daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        if (year % 400 == 0 || (year % 100 != 0 && year % 4 == 0))
          daysInMonth[1] = 29;
        return day > 0 && day <= daysInMonth[month - 1];
      }

      if (id.length > 0) {
        document.getElementById("id").value = id;
      }

      var webroot = "https://hoabinh2024.iwedding.info";
      var events = JSON.parse(
        '{"66422b65c99a831d1005c1f6":"L\u1ec4 C\u01af\u1edaI NH\u00c0 N\u1eee","66422b65c99a831d1005c1f7":"TI\u1ec6C C\u01af\u1edaI NH\u00c0 N\u1eee","66422b65c99a831d1005c1f8":"L\u1ec4 C\u01af\u1edaI NH\u00c0 NAM","66422b65c99a831d1005c1f9":"TI\u1ec6C C\u01af\u1edaI NH\u00c0 NAM"}'
      );
      var is_premium = "0";
      if ($("#search-form").length) {
        $("#search-form").validate({
          errorLabelContainer: $("#search-form div.errors"),
          rules: {
            name: {
              required: true,
            },
          },
          messages: {
            name: {
              required: "Vui lòng nhập thông tin theo yêu cầu để xác nhận!",
            },
          },
          submitHandler: function (form) {
            $("#loading-overlay").css("display", "flex");
            if (id) {
              var formData = $(form).serialize();
              $.ajax({
                url: "https://docs.google.com/forms/u/0/d/e/1FAIpQLSfyKAdsOo_Cfkrd70UfIpN9DerD6WYaegJ_2ejGR46MP6SHEg/formResponse",
                data: formData,
                type: "POST",
                dataType: "xml",
                error: function () {
                  localStorage.setItem("check", true)
                  alert("cảm ơn bạn đã phản hồi ạ");
                  window.location.reload();
                },
              });
              return false;
            } else {
              alert("Lỗi thông tin, Vui lòng thử lại");
            }
          },
        });
      }
      $(document).on("click", ".form-check-input", function (event) {
        if ($(".search-id").hasClass("disabled")) {
          $(".search-id").removeClass("disabled");
        }
      });

      $(document).on("submit", "#confirmation-form", function (event) {
        event.preventDefault();
        var guestID = $(this).find('input[name="guestID"]:checked').val();
        window.location.href = webroot + "/invitation/" + guestID + "#confirm";
        return false;
      });

      $(document).on("click", ".scroll-free-confirm", function (event) {
        $("#free-confirm-form").removeClass("d-none");
        $(".scroll-search-form").removeClass("d-none");
        $("#search-form").addClass("d-none");
        $(".scroll-free-confirm").addClass("d-none");
        $(".text-search-error-message").addClass("d-none");
      });

      // $(document).on('click', '.scroll-search-form', function(event) {
      // 	$("#free-confirm-form").addClass('d-none');
      // 	$(".scroll-search-form").addClass('d-none');
      // 	$("#search-form").removeClass('d-none');
      // 	$(".scroll-free-confirm").removeClass('d-none');
      // 	$(".text-search-error-message").removeClass('d-none');
      // });

      $(window).on("load", function (event) {
        event.preventDefault();
      });

      $("select[name='attendance_status[]']").on("change", function () {
        let eventQuestion = $(this).closest(".event-question");
        let plusOnes = eventQuestion.find("select[name='plus_ones[]']");

        if ($(this).val() == 1) {
          plusOnes.prop("disabled", false);
          checkAttendanceStatus(eventQuestion, true);
        } else {
          plusOnes.removeClass("border-danger");
          plusOnes.prop("disabled", true);
          plusOnes.val(plusOnes.find("option:first").val());
          checkAttendanceStatus(eventQuestion, false);
        }
      });

      function checkAttendanceStatus(eventQuestion, status) {
        eventQuestion
          .find(".row-guest-questions .guest-question-content")
          .each(function (index, formControlElement) {
            let guestQuestionElements =
              $(formControlElement).children(".guest-question");
            if (!status) {
              guestQuestionElements.prop("disabled", true);
              guestQuestionElements.removeClass("border-danger");
              $(formControlElement).removeClass("is-invalid");
              guestQuestionElements.removeClass("is-invalid");
              switch (guestQuestionElements.prop("tagName")) {
                case "TEXTAREA":
                case "INPUT":
                  guestQuestionElements.val("");
                  break;
                case "SELECT":
                  guestQuestionElements.val(
                    guestQuestionElements.find("option:first").val()
                  );
                  break;
                default:
                  guestQuestionElements.val("");
                  break;
              }
            } else {
              guestQuestionElements.prop("disabled", false);
            }
          });
      }
    </script>
    <script>
      async function fetchGoogleSheet() {
        const apiKey = "AIzaSyChXLCI_NcMDxpVi8XSfSopjH2MoijOst0"; // Thay thế bằng API Key của bạn
        const sheetName = "Response"; // Tên của sheet cần truy cập
        const sheetId = "1N5YjzpisADFocd2QH_SqIA1MeArLQn7SZSbrsmp6tu4"; // Thay thế bằng ID của Google Sheet
        const range = "A2:D"; // Thay thế bằng range bạn muốn fetch

        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}!${range}?key=${apiKey}`;
       
        const fetchData = async (url) => {
          const response = await fetch(url);
          if (!response.ok) {
            throw new Error(
              `Failed to fetch data from ${url}: ${response.statusText}`
            );
          }
          return response.json();
        };

        try {
          const data = await fetchData(url)

          dataSheet = data.values.map((e) => ({
            id: e[2],
          }));

          if (id && dataSheet) {
            var parts = dataSheet.find((e) => e.id === id);
            if ((parts.id && id != '1a76514e-f049-47e3-b418-5e1737e40afb') || localStorage.getItem("check")) {
              document.getElementById('search-form').remove()
              document.getElementById('camOn').innerHTML = `<h1 class="mt-2" style="font-family: 'Coiny'">Bạn đã xác nhận tham dự</b>`
            }
          }
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }
      window.onload = fetchGoogleSheet()
    </script>
  </body>
</html>
